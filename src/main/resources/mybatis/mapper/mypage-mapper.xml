<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sist.web.mapper.MyPageMapper">	
	<resultMap type="com.sist.web.vo.MemberVO" id="storeMap">
		<result property="svo.storename" column="storename"/>
		<result property="svo.image" column="image"/>
		<result property="svo.sellcount" column="sellcount"/>
		<result property="svo.reviewcount" column="reviewcount"/>
		<result property="svo.totalscore" column="totalscore"/>
		<result property="svo.scorecount" column="scorecount"/>
		<result property="svo.content" column="content"/>
	</resultMap>
	
	<select id="myPageListData" resultMap="storeMap" parameterType="int">
		SELECT u.no,password,post,addr1,addr2,phone,regdate,email,point,TRUNC(SYSDATE-regdate) as diffday,point,
			   storename,image,sellcount,reviewcount,totalscore,scorecount,content
		FROM user_table u JOIN store s 
		ON u.no=s.no
		WHERE u.no=#{no} 
	</select>
	
	<resultMap type="com.sist.web.vo.TransactionVO" id="tradeMap">
		<result property="tvo.imageurl" column="imageurl"/>
		<result property="tvo.price" column="price"/>
	</resultMap>
		
	<select id="mypageBuyList" resultMap="tradeMap" parameterType="int">
		SELECT tg.imageurl,tg.price,t.seller_name,t.name 
		FROM transaction t JOIN trade_goods tg ON t.seller_id=tg.user_no
		WHERE buyer_id=#{no} 
		ORDER BY tg.price DESC
		OFFSET #{start} ROWS FETCH NEXT 3 ROWS ONLY
	</select>
</mapper>