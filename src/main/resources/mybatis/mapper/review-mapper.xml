<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sist.web.mapper.ReviewMapper">
	<resultMap type="com.sist.web.vo.ReviewVO" id="reviewMap">
		<id property="review_id" column="review_id"/>
		<result property="seller_id" column="seller_id"/>
		<result property="reviewer_id" column="reviewer_id"/>
		<result property="content" column="content"/>
		<result property="created_date" column="created_date"/>
		<result property="modified_date" column="modified_date"/>
		<result property="rating" column="rating"/>
		<result property="dbday" column="dbday"/>
		
		<association property="uvo" javaType="com.sist.web.vo.UserVO">
			<id property="no" column="user_no"/>
			<result property="email" column="email"/>
		</association>
		
		<association property="svo" javaType="com.sist.web.vo.StoreVO">
			<id property="no" column="store_no"/>
			<result property="storename" column="storename"/>
			<result property="image" column="image"/>
			<result property="reviewcount" column="reviewcount"/>
			<result property="totalscore" column="totalscore"/>
			<result property="scorecount" column="scorecount"/>
		</association>
	</resultMap>
	
	<select id="reviewListData" resultMap="reviewMap" parameterType="int">
		SELECT r.review_id,r.seller_id,r.reviewer_id,r.content,TO_CHAR(r.created_date,'YYYY-MM-DD HH24:MI:SS') as dbday,r.modified_date,r.rating,
		       u.no as user_no,u.email,
		       s.no as store_no,s.storename,s.image
		FROM review r
		JOIN user_table u ON r.reviewer_id=u.no
		JOIN store s ON s.no=r.reviewer_id
		WHERE r.seller_id=#{no}
		ORDER BY r.created_date DESC
	</select>
</mapper>
